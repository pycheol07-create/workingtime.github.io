<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>물류팀 업무현황</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Noto+Sans+KR:wght@400;500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="css/style.css">
</head>
<body class="bg-gray-100 text-gray-800 min-h-screen flex items-center justify-center p-4">
    <div id="toast-container" class="fixed bottom-5 right-5 z-[100] space-y-2 w-full max-w-xs"></div>

    {/* ======[ 변경] 앱 콘텐츠를 감싸는 div 추가 (로그인 기능 대비) ====== */}
    <div id="app-content" class="w-full max-w-7xl mx-auto bg-white rounded-2xl shadow-xl p-6 md:p-8 border border-gray-200 relative">

        {/* 날짜 표시 */}
        <div id="current-date-display" class="absolute top-4 left-6 text-lg font-bold text-gray-700"></div>

        <div class="absolute top-4 right-6 flex flex-col items-end gap-2">
            {/* 연결 상태 표시기 */}
            <div id="connection-indicator" class="flex items-center gap-2">
                <span id="status-dot" class="w-2.5 h-2.5 rounded-full bg-gray-400"></span>
                <span id="connection-status" class="text-xs font-medium text-gray-500"></span>
            </div>
            {/* 전체 초기화 버튼 */}
            <button id="reset-app-btn" class="flex items-center gap-1 text-xs text-gray-500 hover:text-red-600 font-semibold transition p-1 rounded hover:bg-red-50">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M4 4v5h5M20 20v-5h-5M4 4l1.5 1.5A9 9 0 0120.5 10.5M20 20l-1.5-1.5A9 9 0 003.5 13.5" />
                </svg>
                <span>초기화</span>
            </button>
            {/* 로그아웃 버튼 (인증 기능 추가 시 사용) */}
            {/* <button id="logout-button" class="hidden ...">로그아웃</button> */}
        </div>

        {/* 헤더 */}
        <header class="mb-8 pt-4 text-center">
            <h1 class="text-3xl md:text-4xl font-bold text-gray-900">물류팀 업무현황</h1>
        </header>

        {/* 요약 정보 대시보드 */}
        <div class="mb-8 bg-gray-800 text-white rounded-lg border border-gray-700 shadow-lg">
            <div id="toggle-summary" class="flex justify-between items-center p-4 cursor-pointer md:cursor-auto">
                <h2 class="text-xl font-bold">실시간 현황판</h2>
                <svg id="summary-arrow" xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 md:hidden transition-transform transform" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
                </svg>
            </div>
            <div id="summary-content" class="hidden md:grid grid-cols-2 sm:grid-cols-4 lg:grid-cols-7 gap-4 p-6 text-center">
                <div class="dashboard-card p-4 rounded-lg">
                    <h4 class="text-sm font-bold uppercase tracking-wider">총원</h4>
                    <p id="summary-total-staff">0</p>
                </div>
                 <div class="dashboard-card p-4 rounded-lg">
                    <h4 class="text-sm font-bold uppercase tracking-wider">휴무</h4>
                    <p id="summary-leave-staff">0</p>
                </div>
                 <div class="dashboard-card p-4 rounded-lg">
                    <h4 class="text-sm font-bold uppercase tracking-wider">근무</h4>
                    <p id="summary-active-staff">0</p>
                </div>
                 <div class="dashboard-card p-4 rounded-lg">
                    <h4 class="text-sm font-bold uppercase tracking-wider">업무중</h4>
                    <p id="summary-working-staff">0</p>
                </div>
                 <div class="dashboard-card p-4 rounded-lg">
                    <h4 class="text-sm font-bold uppercase tracking-wider">대기</h4>
                    <p id="summary-idle-staff">0</p>
                </div>
                 <div class="dashboard-card p-4 rounded-lg">
                    <h4 class="text-sm font-bold uppercase tracking-wider">진행업무</h4>
                    <p id="summary-ongoing-tasks">0</p>
                </div>
                 <div class="dashboard-card p-4 rounded-lg">
                    <h4 class="text-sm font-bold uppercase tracking-wider">업무진행시간</h4>
                    <p id="summary-total-work-time">0</p>
                </div>
            </div>
        </div>


        {/* 실시간 팀 현황 보드 */}
        <div class="mb-8 p-6 bg-gray-50 rounded-lg border border-gray-200">
            <h2 class="text-xl font-bold text-gray-900 mb-4">업무 배정 및 팀 현황</h2>
            <div id="team-status-board" class="space-y-8">
                {/* Real-time status content will be dynamically inserted here */}
            </div>
        </div>

        {/* 완료된 업무 기록 테이블 */}
        <div class="mb-8 p-6 bg-gray-50 rounded-lg border border-gray-200">
            <div id="toggle-completed-log" class="flex justify-between items-center cursor-pointer md:cursor-auto">
                <h2 class="text-xl font-bold text-gray-900">오늘 완료된 업무</h2>
                <svg id="completed-log-arrow" xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 md:hidden transition-transform transform" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
                </svg>
            </div>
            <div id="completed-log-content" class="hidden md:block mt-4">
                <div class="flex flex-wrap gap-2 justify-end items-center mb-4">
                    {/* 기존 버튼들 */}
                    <button id="open-history-btn" class="bg-gray-600 hover:bg-gray-700 text-white font-semibold py-2 px-4 rounded-lg transition duration-300 shadow-md">이력 보기</button>
                    <button id="save-progress-btn" class="bg-sky-600 hover:bg-sky-700 text-white font-semibold py-2 px-4 rounded-lg transition duration-300 shadow-md">중간 저장</button>
                    <button id="end-shift-btn" class="bg-indigo-600 hover:bg-indigo-700 text-white font-semibold py-2 px-4 rounded-lg transition duration-300 shadow-md">업무 마감</button>
                    {/* ======[ "수동 추가" 버튼 추가됨 ]====== */}
                    <button id="open-manual-add-modal-btn" class="bg-teal-600 hover:bg-teal-700 text-white font-semibold py-2 px-4 rounded-lg transition duration-300 shadow-md">수동 추가</button>
                    {/* ==================================== */}
                </div>
                <div class="overflow-auto max-h-[40vh] relative bg-white rounded-md">
                    <table class="w-full text-sm text-left text-gray-600">
                        <thead class="text-xs text-blue-500 uppercase bg-gray-100 sticky top-0 z-10">
                            <tr>
                                <th scope="col" class="px-6 py-3">이름</th>
                                <th scope="col" class="px-6 py-3">업무</th>
                                <th scope="col" class="px-6 py-3">시작 시간</th>
                                <th scope="col" class="px-6 py-3">종료 시간</th>
                                <th scope="col" class="px-6 py-3">소요 시간</th>
                                <th scope="col" class="px-6 py-3 text-right">
                                    <button id="delete-all-completed-btn" class="text-xs font-bold text-red-500 uppercase hover:text-red-700">일괄삭제</button>
                                </th>
                            </tr>
                        </thead>
                        <tbody id="work-log-body"></tbody>
                    </table>
                </div>
            </div>
        </div>

        {/* 오늘의 업무 비중 분석 */}
        <div class="p-6 bg-gray-50 rounded-lg border border-gray-200">
            <div id="toggle-analysis" class="flex justify-between items-center cursor-pointer md:cursor-auto">
                <h2 class="text-xl font-bold text-gray-900">오늘의 업무 비중 분석</h2>
                 <svg id="analysis-arrow" xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 md:hidden transition-transform transform" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
                </svg>
            </div>
            <div id="analysis-content" class="hidden md:block mt-4">
                {/* Chart will be rendered here */}
            </div>
        </div>
    </div> {/* end of #app-content */}

    {/* 로그인 폼 (인증 기능 추가 시 사용) */}
    {/* <div id="login-form" class="w-full max-w-sm mx-auto ..."> ... 로그인 UI ... </div> */}


    {/* Modals */}
     <div id="team-select-modal" class="fixed inset-0 bg-gray-900 bg-opacity-75 flex items-center justify-center hidden z-50 p-4">
        {/* ... (기존 팀 선택 모달 내용) ... */}
     </div>
    <div id="stop-individual-confirm-modal" class="fixed inset-0 bg-gray-900 bg-opacity-75 flex items-center justify-center hidden z-50 p-4">
        {/* ... (기존 개별 종료 확인 모달 내용) ... */}
    </div>
    <div id="delete-confirm-modal" class="fixed inset-0 bg-gray-900 bg-opacity-75 flex items-center justify-center hidden z-50 p-4">
        {/* ... (기존 삭제 확인 모달 내용) ... */}
    </div>
    <div id="reset-app-modal" class="fixed inset-0 bg-gray-900 bg-opacity-75 flex items-center justify-center hidden z-50 p-4">
        {/* ... (기존 초기화 확인 모달 내용) ... */}
    </div>
    <div id="history-modal" class="fixed inset-0 bg-gray-900 bg-opacity-75 flex items-center justify-center hidden z-50 p-4">
        {/* ... (기존 이력 모달 내용) ... */}
    </div>
    <div id="quantity-modal" class="fixed inset-0 bg-gray-900 bg-opacity-75 flex items-center justify-center hidden z-50 p-4">
        {/* ... (기존 처리량 모달 내용) ... */}
    </div>
     <div id="quantity-on-stop-modal" class="fixed inset-0 bg-gray-900 bg-opacity-75 flex items-center justify-center hidden z-50 p-4">
        {/* ... (기존 종료 시 처리량 모달 내용) ... */}
    </div>
    <div id="delete-history-modal" class="fixed inset-0 bg-gray-900 bg-opacity-75 flex items-center justify-center hidden z-50 p-4">
        {/* ... (기존 이력 삭제 모달 내용) ... */}
    </div>
    <div id="edit-record-modal" class="fixed inset-0 bg-gray-900 bg-opacity-75 flex items-center justify-center hidden z-50 p-4">
        {/* ... (기존 기록 수정 모달 내용) ... */}
    </div>
    {/* Task Selection Modal */}
    <div id="task-select-modal" class="fixed inset-0 bg-gray-900 bg-opacity-75 flex items-center justify-center hidden z-50 p-4">
        {/* ... (기존 업무 선택 모달 내용) ... */}
    </div>
    {/* Edit Part-Timer Modal */}
    <div id="edit-part-timer-modal" class="fixed inset-0 bg-gray-900 bg-opacity-75 flex items-center justify-center hidden z-50 p-4">
        {/* ... (기존 알바 수정 모달 내용) ... */}
    </div>

    {/* ======[ 수동 추가 모달 추가됨 ]====== */}
    <div id="manual-add-modal" class="fixed inset-0 bg-gray-900 bg-opacity-75 flex items-center justify-center hidden z-50 p-4">
        <div class="bg-white rounded-2xl shadow-2xl w-full max-w-lg relative">
            <div class="p-6 border-b border-gray-200 flex justify-between items-center">
                <h2 class="text-xl font-bold text-gray-900">완료된 업무 수동 추가</h2>
                <button class="modal-close-btn" data-modal-id="manual-add-modal">&times;</button>
            </div>
            <div class="p-6 space-y-4">
                <div>
                    <label for="manual-member-name" class="block text-sm font-medium text-gray-700">이름</label>
                    <select id="manual-member-name" class="mt-1 w-full bg-white border border-gray-300 rounded-lg p-2 focus:ring-blue-500 focus:border-blue-500">
                        {/* 옵션은 JS로 채워짐 */}
                    </select>
                </div>
                 <div>
                    <label for="manual-task-type" class="block text-sm font-medium text-gray-700">업무</label>
                    <select id="manual-task-type" class="mt-1 w-full bg-white border border-gray-300 rounded-lg p-2 focus:ring-blue-500 focus:border-blue-500">
                        {/* 옵션은 JS로 채워짐 */}
                    </select>
                </div>
                 <div>
                    <label for="manual-start-time" class="block text-sm font-medium text-gray-700">시작 시간 (HH:MM)</label>
                    <input type="time" id="manual-start-time" required class="mt-1 w-full bg-white border border-gray-300 rounded-lg p-2 focus:ring-blue-500 focus:border-blue-500">
                </div>
                 <div>
                    <label for="manual-end-time" class="block text-sm font-medium text-gray-700">종료 시간 (HH:MM)</label>
                    <input type="time" id="manual-end-time" required class="mt-1 w-full bg-white border border-gray-300 rounded-lg p-2 focus:ring-blue-500 focus:border-blue-500">
                </div>
            </div>
            <div class="p-4 bg-gray-50 rounded-b-2xl flex justify-end gap-4">
                <button type="button" id="cancel-manual-add-btn" class="bg-white hover:bg-gray-100 border border-gray-300 text-gray-800 font-bold py-2 px-4 rounded-lg transition">취소</button>
                <button type="button" id="confirm-manual-add-btn" class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded-lg transition">저장</button>
            </div>
        </div>
    </div>
    {/* ================================== */}

    <script type="module" src="js/app.js"></script>
</body>
</html>