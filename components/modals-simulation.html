<div id="cost-simulation-modal" class="fixed inset-0 bg-gray-900 bg-opacity-75 flex items-center justify-center hidden z-[100] p-4">
    <div id="sim-modal-content-box" class="bg-white rounded-2xl shadow-2xl w-full max-w-4xl relative max-h-[95vh] overflow-y-auto">
        <div id="sim-modal-header" class="p-6 border-b border-gray-200 sticky top-0 bg-white z-10 cursor-move">
            <h2 class="text-xl font-bold text-gray-900 flex items-center gap-2">
                💰 운영 시뮬레이션 (다중 업무)
            </h2>
            <button class="modal-close-btn" data-modal-id="cost-simulation-modal">&times;</button>
        </div>
        <div class="p-6 space-y-6">
            
            <div class="flex justify-center bg-gray-100 p-1 rounded-lg">
                <label class="w-1/3 text-center cursor-pointer">
                    <input type="radio" name="sim-mode" value="fixed-workers" class="peer sr-only" checked>
                    <span class="block py-2 px-4 rounded-md text-sm font-medium text-gray-500 peer-checked:bg-white peer-checked:text-indigo-600 peer-checked:shadow-sm transition-all">
                        🕒 소요 시간 & 종료 시각 예측
                    </span>
                </label>
                <label class="w-1/3 text-center cursor-pointer">
                    <input type="radio" name="sim-mode" value="target-time" class="peer sr-only">
                    <span class="block py-2 px-4 rounded-md text-sm font-medium text-gray-500 peer-checked:bg-white peer-checked:text-indigo-600 peer-checked:shadow-sm transition-all">
                        📅 필요 인원 예측
                    </span>
                </label>
                 <label class="w-1/3 text-center cursor-pointer">
                    <input type="radio" name="sim-mode" value="bottleneck" class="peer sr-only">
                    <span class="block py-2 px-4 rounded-md text-sm font-medium text-gray-500 peer-checked:bg-white peer-checked:text-indigo-600 peer-checked:shadow-sm transition-all">
                        ⛓️ 병목 구간 분석
                    </span>
                </label>
            </div>

            <div id="sim-common-settings" class="bg-indigo-50 p-4 rounded-lg border border-indigo-100 flex items-center flex-wrap gap-4">
                <label for="sim-start-time-input" class="text-sm font-semibold text-indigo-900">예상 시작 시각:</label>
                <input type="time" id="sim-start-time-input" class="p-2 border border-indigo-300 rounded-md text-sm" value="09:00">
                
                <div id="sim-end-time-wrapper" class="hidden flex items-center gap-2">
                    <label for="sim-end-time-input" class_member="text-sm font-semibold text-indigo-900">예상 종료 시각:</label>
                    <input type="time" id="sim-end-time-input" class="p-2 border border-indigo-300 rounded-md text-sm" value="17:00">
                </div>

                <p class="text-xs text-indigo-500 flex-grow text-right">* 점심시간(12:30~13:30) 자동 고려됨</p>
            </div>

            <div id="sim-input-area">
                 <div class="flex justify-between items-center mb-2">
                    <h4 class="text-sm font-bold text-gray-700">시뮬레이션 대상 업무 목록</h4>
                    <button id="sim-add-task-row-btn" class="text-xs bg-blue-100 hover:bg-blue-200 text-blue-700 font-semibold px-3 py-1.5 rounded-md transition">
                        + 업무 추가
                    </button>
                </div>
                <table class="w-full text-sm text-left text-gray-600 border rounded-lg overflow-hidden">
                    <thead class="text-xs text-gray-700 uppercase bg-gray-100">
                        <tr>
                            <th class="px-4 py-3">업무</th>
                            <th class="px-4 py-3">목표 수량 (개)</th>
                            <th class="px-4 py-3" id="sim-table-header-worker">투입 인원 (명)</th>
                            <th class="px-4 py-3 text-center">삭제</th>
                        </tr>
                    </thead>
                    <tbody id="sim-task-table-body" class="divide-y divide-gray-200 bg-white">
                        </tbody>
                </table>
            </div>

            <div class="flex items-center justify-end px-1 pt-2">
                <input type="checkbox" id="sim-include-linked-tasks-checkbox" class="h-4 w-4 text-indigo-600 border-gray-300 rounded focus:ring-indigo-500" checked>
                <label for="sim-include-linked-tasks-checkbox" class="ml-2 block text-sm text-gray-700 cursor-pointer select-none">
                    '사전 작업' 등 연관 업무 시간 포함
                </label>
            </div>
            <button id="sim-calculate-btn" class="w-full bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-4 px-6 rounded-xl transition shadow-md active:scale-[0.98] text-lg">
                시뮬레이션 실행 🚀
            </button>

            <div id="sim-result-container" class="hidden space-y-6 pt-6 border-t border-gray-200">
                <div class="grid grid-cols-3 gap-4 text-center">
                    <div class="bg-blue-50 p-4 rounded-xl border border-blue-100">
                        <div id="sim-summary-label-1" class="text-sm text-blue-600 mb-1 font-medium">총 예상 소요 시간</div>
                        <div id="sim-summary-value-1" class="text-2xl font-extrabold text-blue-800">-</div>
                    </div>
                     <div class="bg-green-50 p-4 rounded-xl border border-green-100">
                        <div id="sim-summary-label-2" class="text-sm text-green-600 mb-1 font-medium">예상 종료 시각</div>
                        <div id="sim-summary-value-2" class="text-2xl font-extrabold text-green-800">-</div>
                    </div>
                    <div class="bg-red-50 p-4 rounded-xl border border-red-100">
                        <div id="sim-summary-label-3" class="text-sm text-red-600 mb-1 font-medium">예상 총 인건비</div>
                        <div id="sim-summary-value-3" class="text-2xl font-extrabold text-red-800">-</div>
                    </div>
                </div>
                <div>
                    <h4 class="text-md font-bold text-gray-800 mb-3">📋 개별 업무 예측 결과</h4>
                    <div class="overflow-x-auto border rounded-lg">
                        <table class="w-full text-sm text-left text-gray-600">
                            <thead id="sim-result-thead" class="bg-gray-50 text-xs uppercase text-gray-700">
                                <tr>
                                    <th class="px-4 py-2">업무</th>
                                    <th class="px-4 py-2 text-right">표준 속도 (개/분)</th>
                                    <th class="px-4 py-2 text-right">예상 시간</th>
                                    <th class="px-4 py-2 text-right">예상 비용</th>
                                    <th class="px-4 py-2 text-right">종료 시각</th>
                                </tr>
                            </thead>
                            <tbody id="sim-result-tbody" class="divide-y divide-gray-100"></tbody>
                        </table>
                    </div>
                </div>
            </div>

            <div id="sim-bottleneck-container" class="hidden pt-6 border-t border-gray-200">
                <h4 class="text-lg font-bold text-gray-800 mb-3">⛓️ 병목 구간 TOP 5 분석</h4>
                <p class="text-sm text-gray-600 mb-4 bg-yellow-50 p-3 rounded border border-yellow-100">
                    💡 동일한 수량(1,000개)을 처리한다고 가정했을 때, 가장 시간이 오래 걸리는(속도가 느린) 업무 순위입니다.
                </p>
                <div class="bg-white border border-gray-200 rounded-lg overflow-hidden">
                    <table class="w-full text-sm text-left">
                        <thead class="bg-gray-100 text-gray-700 text-xs uppercase">
                            <tr>
                                <th class="px-4 py-3">순위</th>
                                <th class="px-4 py-3">업무명</th>
                                <th class="px-4 py-3 text-right">필요 시간 (1인 기준)</th>
                                <th class="px-4 py-3 text-right">표준 속도 (개/분)</th>
                            </tr>
                        </thead>
                        <tbody id="sim-bottleneck-tbody" class="divide-y divide-gray-100"></tbody>
                    </table>
                </div>
            </div>

        </div>
    </div>
</div>